import{u as ee}from"./app-CQto9ei9.js";import{_ as te,V as B,c as ae,a as W,d as le}from"./VCard-BwZTtDha.js";import{N as $,l as k,a1 as d,e as n,f as E,a5 as v,w as i,o as u,h as F,V as K,i as e,j as T,L as j,a4 as c,Y as S,a7 as G}from"./index-x0uWx8_N.js";import{V as A}from"./VTooltip-CsjF_WRv.js";import{V as re,a as se}from"./VList-Dtj1b0B-.js";import{V as ie}from"./VAvatar-BnXmNYTE.js";import{V as oe}from"./VTable-CzFoqyF_.js";import"./forwardRefs-DdXr6tAt.js";const ne={class:"menu-page"},ce={class:"d-flex flex-column align-end"},ue={class:"text-h6"},de={class:"text-caption"},me={class:"pa-2"},pe={class:"text-left ma-0 pa-0",style:{"list-style-type":"none"}},fe={key:0},Fe={key:1},be={key:2},ve={key:3},ye={key:0},ge={key:1},he={key:0},ke={key:1},xe={class:"text-primary font-weight-bold"},_e={class:"text-caption mt-3"},Me={__name:"menu",setup(Ce){const b=ee(),H=$(b.$state.timeCostScale),Y=$(b.$state.matCostScale),L=$(b.$state.selectedJob),Q=$(b.$state.selectedCalculationMethod);$(!1);const x=k(()=>b.currentJob),M=k(()=>b.fees),I=k(()=>b.$state.variables.diagnosticFee);k(()=>b.$state.jobs),k(()=>b.$state.calculationMethods.map(m=>({id:m.id,name:m.name})));function R(m,a,l,V){const r=JSON.parse(JSON.stringify(b.$state));r.selectedJob=m,r.timeCostScale=a,r.matCostScale=l,r.selectedCalculationMethod=V;const p=r.jobs[m];if(!p)return[];const q=r.calculationMethods.find(o=>o.id===V);if(!q)return[];const z=Object.entries(r.markupScales[r.selectedMarkupScale].values).map(([o,s])=>[parseFloat(o.slice(1).replace(",","")),s]).sort((o,s)=>o[0]-s[0]),Z=Object.entries(r.serviceTierScales[r.selectedServiceTierScale].values).filter(([o])=>!isNaN(parseFloat(o))).map(([o,s])=>[parseInt(o),s]).sort((o,s)=>o[0]-s[0]);function D(o,s){if(!o)return 1;const t=parseFloat(s)||1;return o==="low"?t*.9:o==="high"?t*1.1:t}function P(o,s,t){return o*(parseFloat(s)||0)*t}const O=[];for(const[o,s]of Z){let t={tier:o};switch(q.id){case"standard":{const f=p.material*r.variables.salesTax*l;let y=1,g=!1;for(const[_,N]of z)if(f===_){y=N,g=!0;break}if(!g)for(const[_,N]of z)f>=_&&(y=N);const C=D(p.seasonalDemand,r.variables.seasonalAdjustment),h=p.requiresCertification&&r.variables.certificationBonus||0,w=P(f*y,r.variables.warrantyFactor,s);t.matCost=f,t.matMarkup=y,t.matFee=f*y*s*C,t.laborFee=p.hours*r.variables.hourlyLaborFee*a*s,t.warrantyFee=w,t.certificationFee=h,t.totalFee=t.matFee+t.laborFee+r.variables.diagnosticFee+w+h;break}case"cost-plus":{const f=p.material*r.variables.salesTax*l,y=p.hours*r.variables.hourlyLaborFee*a,g=r.variables.materialMarkup||.4,C=r.variables.laborMarkup||.65,h=D(p.seasonalDemand,r.variables.seasonalAdjustment),w=p.requiresCertification&&r.variables.certificationBonus||0,_=P(f*(1+g),r.variables.warrantyFactor,s);t.matCost=f,t.matMarkup=(1+g).toFixed(2),t.matFee=f*(1+g)*s*h,t.laborFee=y*(1+C)*s,t.warrantyFee=_,t.certificationFee=w,t.totalFee=t.matFee+t.laborFee+r.variables.diagnosticFee+_+w;break}default:{const f=p.material*r.variables.salesTax*l,y=D(p.seasonalDemand,r.variables.seasonalAdjustment),g=p.requiresCertification&&r.variables.certificationBonus||0,C=r.variables.warrantyFactor||0,h=f*C*s;t.matCost=f,t.matMarkup=2,t.matFee=f*2*s*y,t.laborFee=p.hours*r.variables.hourlyLaborFee*a*s,t.warrantyFee=h,t.certificationFee=g,t.totalFee=t.matFee+t.laborFee+r.variables.diagnosticFee+h+g}}O.push(t)}return O}k(()=>R(L.value,H.value,Y.value,Q.value)),k(()=>b.$state.jobs[L.value]);function J(m){return{1:"Band-Aid",2:"Bronze",3:"Silver",4:"Gold",5:"Platinum"}[m]||`Tier ${m}`}function U(m){return{1:"red-lighten-1",2:"amber-darken-2",3:"grey",4:"amber-darken-1",5:"blue-grey-lighten-3"}[m]||"primary"}function X(m){return{1:"mdi-medical-bag",2:"mdi-trophy-variant",3:"mdi-silverware",4:"mdi-gold",5:"mdi-diamond-stone"}[m]||"mdi-star"}return(m,a)=>(u(),d("div",ne,[n(B,{class:"mb-4 px-4 py-2"},{default:i(()=>[n(W,{class:"text-h5 d-flex align-center"},{default:i(()=>[n(K,{icon:"mdi-arrow-left",variant:"text",size:"small",to:{path:"/"},class:"mr-2"}),a[1]||(a[1]=F(" Price Menu ")),n(A,{location:"end"},{activator:i(({props:l})=>[n(T,j({icon:"mdi-information-outline",color:"info",size:"small",class:"ml-2"},l),null,16)]),default:i(()=>[a[0]||(a[0]=e("div",{class:"pa-2"},[e("p",null,"This is the menu of prices to present to your customer."),e("p",null,"Each tier represents a different level of service and quality.")],-1))]),_:1})]),_:1}),n(le,null,{default:i(()=>[F("Service options for "+c(x.value.title),1)]),_:1})]),_:1}),n(B,{class:"mb-4 px-2 py-2"},{default:i(()=>[n(re,null,{default:i(()=>[(u(!0),d(S,null,G(M.value,l=>(u(),E(se,{key:l.tier,title:J(l.tier),subtitle:`${x.value.requiresCertification?"Certified technician required":"Standard service"}`,active:!1,variant:"flat",rounded:"lg",class:"mb-1"},{prepend:i(()=>[n(ie,{color:U(l.tier),variant:"tonal",class:"mr-3"},{default:i(()=>[n(T,null,{default:i(()=>[F(c(X(l.tier)),1)]),_:2},1024)]),_:2},1032,["color"])]),append:i(()=>[e("div",ce,[e("div",ue," $"+c(l.totalFee.toFixed(2)),1),e("div",de,[F(" Material: $"+c(l.matFee.toFixed(2))+" | Labor: $"+c(l.laborFee.toFixed(2))+" ",1),n(A,{location:"start","content-class":"tooltip-bright"},{activator:i(({props:V})=>[n(T,j({icon:"mdi-information-outline",color:"info",size:"x-small",class:"ml-1",ref_for:!0},V),null,16)]),default:i(()=>[e("div",me,[a[2]||(a[2]=e("p",{class:"mb-1"}," Price includes: ",-1)),e("ul",pe,[e("li",null,"- Diagnostic fee: $"+c(I.value),1),l.warrantyFee?(u(),d("li",fe," - Warranty protection: $"+c(l.warrantyFee.toFixed(2)),1)):v("",!0),l.certificationFee>0?(u(),d("li",Fe," - Certification fee: $"+c(l.certificationFee.toFixed(2)),1)):v("",!0),x.value.seasonalDemand==="high"?(u(),d("li",be," - Seasonal pricing: High demand ")):v("",!0),x.value.seasonalDemand==="low"?(u(),d("li",ve," - Seasonal pricing: Discounted ")):v("",!0)])])]),_:2},1024)])])]),_:2},1032,["title","subtitle"]))),128))]),_:1})]),_:1}),M.value.length>0?(u(),E(B,{key:0,class:"mb-4 pa-4"},{default:i(()=>[n(W,{class:"d-flex align-center"},{default:i(()=>[a[4]||(a[4]=e("span",null,"Pricing Details",-1)),n(A,{location:"end"},{activator:i(({props:l})=>[n(T,j({icon:"mdi-information-outline",color:"info",size:"small",class:"ml-2"},l),null,16)]),default:i(()=>[a[3]||(a[3]=e("div",{class:"pa-2"},[e("p",null,"Detailed breakdown of how each price is calculated."),e("ul",{class:"text-left"},[e("li",null,[e("strong",null,"Material Cost:"),F(" Base cost with tax and scaling")]),e("li",null,[e("strong",null,"Material Markup:"),F(" Multiplier based on cost")]),e("li",null,[e("strong",null,"Material Fee:"),F(" Final material charge")]),e("li",null,[e("strong",null,"Labor Fee:"),F(" Time charge based on hourly rates")]),e("li",null,[e("strong",null,"Total Fee:"),F(" Final price including diagnostic fee")])])],-1))]),_:1})]),_:1}),n(oe,{density:"compact"},{default:i(()=>[e("thead",null,[e("tr",null,[a[5]||(a[5]=e("th",null,"Tier",-1)),a[6]||(a[6]=e("th",null,"Material Cost",-1)),a[7]||(a[7]=e("th",null,"Material Markup",-1)),a[8]||(a[8]=e("th",null,"Material Fee",-1)),a[9]||(a[9]=e("th",null,"Labor Fee",-1)),M.value[0].warrantyFee?(u(),d("th",ye," Warranty ")):v("",!0),M.value[0].certificationFee>0?(u(),d("th",ge," Cert. Fee ")):v("",!0),a[10]||(a[10]=e("th",null,"Total Fee",-1))])]),e("tbody",null,[(u(!0),d(S,null,G(M.value,l=>(u(),d("tr",{key:l.tier},[e("td",null,c(J(l.tier)),1),e("td",null,"$"+c(l.matCost.toFixed(2)),1),e("td",null,c(l.matMarkup)+"x",1),e("td",null,"$"+c(l.matFee.toFixed(2)),1),e("td",null,"$"+c(l.laborFee.toFixed(2)),1),l.warrantyFee?(u(),d("td",he," $"+c(l.warrantyFee.toFixed(2)),1)):v("",!0),l.certificationFee>0?(u(),d("td",ke," $"+c(l.certificationFee.toFixed(2)),1)):v("",!0),e("td",xe," $"+c(l.totalFee.toFixed(2)),1)]))),128))])]),_:1}),e("div",_e,[a[11]||(a[11]=e("strong",null,"Note:",-1)),F(" All prices include diagnostic fee of $"+c(I.value)+" ",1),x.value.seasonalDemand==="high"?(u(),d(S,{key:0},[F(" | Seasonal high demand pricing applied ")],64)):v("",!0),x.value.seasonalDemand==="low"?(u(),d(S,{key:1},[F(" | Seasonal low demand discount applied ")],64)):v("",!0)])]),_:1})):v("",!0),n(ae,{class:"d-flex justify-center mb-4"},{default:i(()=>[n(K,{color:"secondary",to:{name:"diagnosis"},variant:"flat",rounded:"lg"},{default:i(()=>a[12]||(a[12]=[F(" Back to Diagnosis ")])),_:1})]),_:1})]))}},je=te(Me,[["__scopeId","data-v-3a22a95f"]]);export{je as default};
