import{l as h,N as c,a1 as X,e as a,w as t,o as Y,h as i,V as f,i as o,j,L as v,a4 as g,a3 as S}from"./index-x0uWx8_N.js";import{u as Z}from"./app-CQto9ei9.js";import{_ as ee,V as q,a as k,d as le,b as F,c as I}from"./VCard-BwZTtDha.js";import{V as M,a as z,b as ae}from"./VSwitch-DYBhyaiv.js";import{V as D}from"./VTooltip-CsjF_WRv.js";import{V as te}from"./VDataTable-D3gOdQvq.js";import{f as y,e as b,g as $}from"./VSelect-DAPLtHuN.js";import{V as N}from"./VForm-Y8zpW2jJ.js";import{V as B,a as p}from"./VRow-C7L0s5NK.js";import{a as H}from"./VList-Dtj1b0B-.js";import"./VAvatar-BnXmNYTE.js";import"./forwardRefs-DdXr6tAt.js";import"./VTable-CzFoqyF_.js";const oe={class:"jobs-management"},ie={class:"d-flex align-center"},re={__name:"jobs",setup(ne){const d=Z(),R=h(()=>d.$state.jobs),s=h(()=>d.$state.jobCategories||[]),L=[{title:"Title",key:"title"},{title:"Category",key:"categoryId"},{title:"Material ($)",key:"material"},{title:"Hours",key:"hours"},{title:"Complexity",key:"complexity"},{title:"Emergency",key:"emergencyFactor"},{title:"Certified",key:"requiresCertification"},{title:"Demand",key:"seasonalDemand"},{title:"Actions",key:"actions",sortable:!1}];function P(n){return{1:"mdi-water-pump",2:"mdi-lightning-bolt",3:"mdi-hvac",4:"mdi-dishwasher"}[n]||"mdi-tools"}function _(n){const l={1:"Plumbing",2:"Electrical",3:"HVAC",4:"Appliance"};if(l[n])return l[n];if(s.value&&Array.isArray(s.value)){const e=s.value.find(u=>u.id===n);if(e)return e.name}return"Unknown"}function G(n){const l={1:"blue",2:"amber",3:"green",4:"red"};if(l[n])return l[n];if(s.value&&Array.isArray(s.value)){const e=s.value.find(u=>u.id===n);if(e)return e.color}return"grey"}const J=c(null),C=c(!1),V=c(!1),x=c(null),A=c(!1),w=c(!1),m=c({name:"",color:"blue"}),O=[{title:"Blue",value:"blue"},{title:"Red",value:"red"},{title:"Green",value:"green"},{title:"Purple",value:"purple"},{title:"Amber",value:"amber"},{title:"Cyan",value:"cyan"},{title:"Indigo",value:"indigo"},{title:"Teal",value:"teal"},{title:"Orange",value:"orange"},{title:"Pink",value:"pink"}],r=c({id:null,title:"",material:0,hours:0,complexity:1,emergencyFactor:1});function E(n){if(n){if(A.value=!0,r.value={...n},n.categoryId&&s.value.length>0){const l=s.value.find(e=>e.id===n.categoryId);r.value.categoryId=l||s.value[0]}}else A.value=!1,r.value={id:null,title:"",material:0,hours:0,complexity:1,emergencyFactor:1,seasonalDemand:"medium",requiresCertification:!1,categoryId:s.value.length>0?s.value[0]:1};C.value=!0}async function T(){const n=J.value;if(n&&await n.validate()){const l=typeof r.value.categoryId=="object"?r.value.categoryId.id:r.value.categoryId,e={...r.value,categoryId:l,material:parseFloat(r.value.material),hours:parseFloat(r.value.hours),complexity:parseFloat(r.value.complexity||1),emergencyFactor:parseFloat(r.value.emergencyFactor||1),seasonalDemand:r.value.seasonalDemand||"medium",requiresCertification:!!r.value.requiresCertification};A.value?d.updateJob(e.id,e):d.addJob(e),C.value=!1}}function K(n){x.value=n,V.value=!0}function Q(){x.value&&(d.deleteJob(x.value.id),V.value=!1,x.value=null)}function W(n){return`data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"><rect width="24" height="24" fill="${n}" /></svg>`}function U(){if(!m.value.name||!m.value.color)return;let n=0;d.$state.jobCategories&&Array.isArray(d.$state.jobCategories)&&(n=d.$state.jobCategories.reduce((e,u)=>u.id>e?u.id:e,0));const l={id:n+1,name:m.value.name,color:m.value.color};d.$state.jobCategories||(d.$state.jobCategories=[]),d.$state.jobCategories.push(l),m.value={name:"",color:"blue"},w.value=!1}return(n,l)=>(Y(),X("div",oe,[a(q,{class:"mb-4 px-4 py-2"},{default:t(()=>[a(k,{class:"text-h5 d-flex align-center"},{default:t(()=>[a(f,{icon:"mdi-arrow-left",variant:"text",size:"small",to:{name:"admin"},class:"mr-2"}),l[19]||(l[19]=i(" Job Management ")),a(D,{location:"end"},{activator:t(({props:e})=>[a(j,v({icon:"mdi-information-outline",color:"info",size:"small",class:"ml-2"},e),null,16)]),default:t(()=>[l[18]||(l[18]=o("div",{class:"pa-2"},[o("p",null,"Create and manage the jobs or services you offer to customers."),o("p",null,"Each job requires information about material costs, time, and complexity factors.")],-1))]),_:1})]),_:1}),a(le,null,{default:t(()=>l[20]||(l[20]=[i("Add, edit, or remove jobs")])),_:1})]),_:1}),a(q,{class:"mb-4"},{default:t(()=>[a(k,{class:"d-flex align-center"},{default:t(()=>[l[24]||(l[24]=o("span",null,"Job List",-1)),a(D,{location:"end"},{activator:t(({props:e})=>[a(j,v({icon:"mdi-information-outline",color:"info",size:"small",class:"ml-2"},e),null,16)]),default:t(()=>[l[21]||(l[21]=o("div",{class:"pa-2"},[o("p",null,"Each job will appear as an option during diagnosis and pricing."),o("ul",{class:"text-left"},[o("li",null,[o("strong",null,"Material:"),i(" Base cost of materials before tax")]),o("li",null,[o("strong",null,"Hours:"),i(" Estimated time to complete the job")]),o("li",null,[o("strong",null,"Complexity:"),i(" Factor applied to material pricing in the Value-Based model")]),o("li",null,[o("strong",null,"Emergency:"),i(" Factor applied to labor pricing in the Value-Based model")])])],-1))]),_:1}),a(z),a(f,{color:"secondary","prepend-icon":"mdi-tag-plus",variant:"outlined",size:"small",class:"mr-2",onClick:l[0]||(l[0]=e=>w.value=!0)},{default:t(()=>l[22]||(l[22]=[i(" Add Category ")])),_:1}),a(f,{color:"primary","prepend-icon":"mdi-plus",variant:"tonal",size:"small",onClick:l[1]||(l[1]=e=>E(null))},{default:t(()=>l[23]||(l[23]=[i(" Add New Job ")])),_:1})]),_:1}),a(F,null,{default:t(()=>[a(te,{headers:L,items:R.value,"items-per-page":10,density:"compact",class:"elevation-1"},{"item.categoryId":t(({item:e})=>[o("div",ie,[a(y,{color:G(e.categoryId),size:"small",class:"mr-2"},null,8,["color"]),i(" "+g(_(e.categoryId)),1)])]),"item.requiresCertification":t(({item:e})=>[a(y,{size:"x-small",color:e.requiresCertification?"purple":"grey",variant:e.requiresCertification?"flat":"outlined"},{default:t(()=>[i(g(e.requiresCertification?"Required":"No"),1)]),_:2},1032,["color","variant"])]),"item.seasonalDemand":t(({item:e})=>[a(y,{size:"x-small",color:e.seasonalDemand==="high"?"red":e.seasonalDemand==="medium"?"blue":"green",variant:"flat"},{default:t(()=>[i(g(e.seasonalDemand),1)]),_:2},1032,["color"])]),"item.actions":t(({item:e})=>[a(f,{icon:"mdi-pencil",variant:"text",size:"small",color:"blue",onClick:u=>E(e)},null,8,["onClick"]),a(f,{icon:"mdi-delete",variant:"text",size:"small",color:"red",onClick:u=>K(e)},null,8,["onClick"])]),_:1},8,["items"])]),_:1})]),_:1}),a(M,{modelValue:C.value,"onUpdate:modelValue":l[11]||(l[11]=e=>C.value=e),"max-width":"600"},{default:t(()=>[a(q,null,{default:t(()=>[a(k,null,{default:t(()=>[i(g(A.value?"Edit Job":"Add New Job"),1)]),_:1}),a(F,null,{default:t(()=>[a(N,{ref_key:"jobForm",ref:J,onSubmit:S(T,["prevent"])},{default:t(()=>[a(B,null,{default:t(()=>[a(p,{cols:"12"},{default:t(()=>[a(b,{modelValue:r.value.title,"onUpdate:modelValue":l[2]||(l[2]=e=>r.value.title=e),label:"Job Title",required:"",rules:[e=>!!e||"Title is required"]},null,8,["modelValue","rules"])]),_:1}),a(p,{cols:"12",sm:"6"},{default:t(()=>[a($,{modelValue:r.value.categoryId,"onUpdate:modelValue":l[3]||(l[3]=e=>r.value.categoryId=e),items:s.value,"item-title":"name","item-value":"id",label:"Job Category",required:"",rules:[e=>!!e||"Category is required"],"return-object":""},{selection:t(({item:e})=>[a(y,{color:e.raw.color,size:"small",class:"mr-1"},null,8,["color"]),i(" "+g(e.raw.name),1)]),item:t(({item:e,props:u})=>[a(H,v(u,{"prepend-avatar":P(e.raw.id),title:e.raw.name}),{prepend:t(()=>[a(y,{color:e.raw.color,size:"small",class:"mr-2"},null,8,["color"])]),_:2},1040,["prepend-avatar","title"])]),_:1},8,["modelValue","items","rules"])]),_:1}),a(p,{cols:"12",sm:"6"},{default:t(()=>[a($,{modelValue:r.value.seasonalDemand,"onUpdate:modelValue":l[4]||(l[4]=e=>r.value.seasonalDemand=e),items:[{title:"Low Demand",value:"low"},{title:"Medium Demand",value:"medium"},{title:"High Demand",value:"high"}],"item-title":"title","item-value":"value",label:"Seasonal Demand",hint:"Affects pricing with seasonal adjustments","persistent-hint":""},null,8,["modelValue"])]),_:1}),a(p,{cols:"12",sm:"6"},{default:t(()=>[a(b,{modelValue:r.value.material,"onUpdate:modelValue":l[5]||(l[5]=e=>r.value.material=e),modelModifiers:{number:!0},label:"Material Cost ($)",type:"number",step:"0.01",min:"0",required:"",rules:[e=>!!e||"Material cost is required",e=>e>=0||"Material cost must be positive"]},null,8,["modelValue","rules"])]),_:1}),a(p,{cols:"12",sm:"6"},{default:t(()=>[a(b,{modelValue:r.value.hours,"onUpdate:modelValue":l[6]||(l[6]=e=>r.value.hours=e),modelModifiers:{number:!0},label:"Estimated Hours",type:"number",step:"0.1",min:"0",required:"",rules:[e=>!!e||"Hours are required",e=>e>=0||"Hours must be positive"]},null,8,["modelValue","rules"])]),_:1}),a(p,{cols:"12",sm:"6"},{default:t(()=>[a(b,{modelValue:r.value.complexity,"onUpdate:modelValue":l[7]||(l[7]=e=>r.value.complexity=e),modelModifiers:{number:!0},label:"Complexity Factor",type:"number",step:"0.1",min:"0.5",max:"5",hint:"1.0 = standard complexity, higher values = more complex","persistent-hint":"",rules:[e=>!!e||"Complexity factor is required",e=>e>=.5||"Minimum complexity is 0.5",e=>e<=5||"Maximum complexity is 5"]},{append:t(()=>[a(D,{location:"end"},{activator:t(({props:e})=>[a(j,v({icon:"mdi-information-outline",color:"info",size:"small"},e),null,16)]),default:t(()=>[l[25]||(l[25]=o("div",{class:"pa-2",style:{"max-width":"300px"}},[o("p",null,[o("strong",null,"Complexity Factor"),i(" affects material costs in Value-Based pricing.")]),o("ul",{class:"text-left"},[o("li",null,[o("strong",null,"0.5-0.9:"),i(" Simple job with easily available materials")]),o("li",null,[o("strong",null,"1.0:"),i(" Standard complexity job (baseline)")]),o("li",null,[o("strong",null,"1.1-2.0:"),i(" Moderate complexity requiring specialized materials")]),o("li",null,[o("strong",null,"2.1-5.0:"),i(" High complexity requiring premium or custom materials")])])],-1))]),_:1})]),_:1},8,["modelValue","rules"])]),_:1}),a(p,{cols:"12"},{default:t(()=>[a(ae,{modelValue:r.value.requiresCertification,"onUpdate:modelValue":l[8]||(l[8]=e=>r.value.requiresCertification=e),color:"purple",label:"Requires Certification",hint:"Jobs requiring certified technicians may have additional fees","persistent-hint":"","hide-details":"auto"},{append:t(()=>[a(D,{location:"end"},{activator:t(({props:e})=>[a(j,v({icon:"mdi-information-outline",color:"info",size:"small"},e),null,16)]),default:t(()=>[l[26]||(l[26]=o("div",{class:"pa-2",style:{"max-width":"300px"}},[o("p",null,[o("strong",null,"Certification Requirement"),i(" indicates that this job can only be performed by technicians with specialized certifications.")]),o("p",null,"If certification fees are enabled in the admin settings, this job will have an additional fee applied.")],-1))]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(p,{cols:"12",sm:"6"},{default:t(()=>[a(b,{modelValue:r.value.emergencyFactor,"onUpdate:modelValue":l[9]||(l[9]=e=>r.value.emergencyFactor=e),modelModifiers:{number:!0},label:"Emergency Factor",type:"number",step:"0.1",min:"1",max:"3",hint:"1.0 = standard service, higher values = urgent/emergency","persistent-hint":"",rules:[e=>!!e||"Emergency factor is required",e=>e>=1||"Minimum emergency factor is 1",e=>e<=3||"Maximum emergency factor is 3"]},{append:t(()=>[a(D,{location:"end"},{activator:t(({props:e})=>[a(j,v({icon:"mdi-information-outline",color:"info",size:"small"},e),null,16)]),default:t(()=>[l[27]||(l[27]=o("div",{class:"pa-2",style:{"max-width":"300px"}},[o("p",null,[o("strong",null,"Emergency Factor"),i(" affects labor costs in Value-Based pricing.")]),o("ul",{class:"text-left"},[o("li",null,[o("strong",null,"1.0:"),i(" Regular scheduled service (normal business hours)")]),o("li",null,[o("strong",null,"1.5-2.0:"),i(" Expedited service or after-hours call")]),o("li",null,[o("strong",null,"2.1-3.0:"),i(" Emergency service (nights, weekends, holidays)")])]),o("p",{class:"text-caption mt-2"}," This factor represents the premium customers are willing to pay for rapid service during off-hours. ")],-1))]),_:1})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},512)]),_:1}),a(I,null,{default:t(()=>[a(z),a(f,{color:"grey",variant:"text",onClick:l[10]||(l[10]=e=>C.value=!1)},{default:t(()=>l[28]||(l[28]=[i(" Cancel ")])),_:1}),a(f,{color:"primary",onClick:T},{default:t(()=>l[29]||(l[29]=[i(" Save ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(M,{modelValue:V.value,"onUpdate:modelValue":l[13]||(l[13]=e=>V.value=e),"max-width":"400"},{default:t(()=>[a(q,null,{default:t(()=>[a(k,null,{default:t(()=>l[30]||(l[30]=[i("Confirm Delete")])),_:1}),a(F,null,{default:t(()=>{var e;return[i(' Are you sure you want to delete the job "'+g((e=x.value)==null?void 0:e.title)+'"? This action cannot be undone. ',1)]}),_:1}),a(I,null,{default:t(()=>[a(z),a(f,{color:"grey",variant:"text",onClick:l[12]||(l[12]=e=>V.value=!1)},{default:t(()=>l[31]||(l[31]=[i(" Cancel ")])),_:1}),a(f,{color:"error",onClick:Q},{default:t(()=>l[32]||(l[32]=[i(" Delete ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(M,{modelValue:w.value,"onUpdate:modelValue":l[17]||(l[17]=e=>w.value=e),"max-width":"500px"},{default:t(()=>[a(q,null,{default:t(()=>[a(k,null,{default:t(()=>l[33]||(l[33]=[i("Add New Category")])),_:1}),a(F,null,{default:t(()=>[a(N,{onSubmit:S(U,["prevent"])},{default:t(()=>[a(B,null,{default:t(()=>[a(p,{cols:"12"},{default:t(()=>[a(b,{modelValue:m.value.name,"onUpdate:modelValue":l[14]||(l[14]=e=>m.value.name=e),label:"Category Name",required:""},null,8,["modelValue"])]),_:1}),a(p,{cols:"12"},{default:t(()=>[a($,{modelValue:m.value.color,"onUpdate:modelValue":l[15]||(l[15]=e=>m.value.color=e),items:O,label:"Category Color",required:""},{selection:t(({item:e})=>[a(y,{color:e.value,size:"small",class:"mr-2"},null,8,["color"]),i(" "+g(e.title),1)]),item:t(({item:e,props:u})=>[a(H,v(u,{title:e.title,"prepend-avatar":W(e.value)}),null,16,["title","prepend-avatar"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),a(I,null,{default:t(()=>[a(z),a(f,{color:"error",variant:"text",onClick:l[16]||(l[16]=e=>w.value=!1)},{default:t(()=>l[34]||(l[34]=[i(" Cancel ")])),_:1}),a(f,{color:"primary",variant:"elevated",disabled:!m.value.name||!m.value.color,onClick:U},{default:t(()=>l[35]||(l[35]=[i(" Add Category ")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},xe=ee(re,[["__scopeId","data-v-ef8b7546"]]);export{xe as default};
